@{
    ViewBag.Title = "在线开发（单表）";
    Layout = "~/Views/Shared/_LayoutForm.cshtml";
}
<link href="~/Content/scripts/plugins/jqgrid/jqgrid.css" rel="stylesheet" />
<script src="~/Content/scripts/plugins/jqgrid/grid.locale-cn.js"></script>
<script src="~/Content/scripts/plugins/jqgrid/jqgrid.min.js"></script>
<script src="~/Content/scripts/plugins/layout/jquery.layout.js"></script>
<link href="~/Content/styles/berry-applayout.css" rel="stylesheet" />
<script src="~/Content/scripts/plugins/syntaxhighlighter/scripts/shCore.js"></script>
<script src="~/Content/scripts/plugins/syntaxhighlighter/scripts/shBrushCSharp.js"></script>
<script type="text/javascript" src="~/Content/scripts/plugins/syntaxhighlighter/scripts/shBrushJScript.js"></script>
<link type="text/css" rel="stylesheet" href="~/Content/scripts/plugins/syntaxhighlighter/styles/shCoreDefault.css" />

<script>
    $(function () {
        initialPage();
        GetDataSource();
    })
    //初始化页面
    function initialPage() {
        //所在区域
        $("#OutputAreas").ComboBox({
            description: "==请选择==",
            height: "200px"
        }).ComboBoxSetValue('BaseManage');
        //功能上级
        $("#ModuleParentId").ComboBoxTree({
            url: "../../AuthorizeManage/Module/GetTreeJson",
            description: "==请选择==",
            height: "300px",
            allowSearch: true
        });
        //加载导向
        $('#wizard').wizard().on('change', function (e, data) {
            var $finish = $("#btn_finish");
            var $next = $("#btn_next");
            if (data.direction == "next") {
                switch (data.step) {
                    case 1:
                        var pk = $("#gridTable").jqGridRowValue("pk");
                        var tablename = $("#gridTable").jqGridRowValue("name");
                        var name = tablename.replace("_", "").replace("_", "");
                        var tdescription = $("#gridTable").jqGridRowValue("tdescription");
                        if (!pk) {
                            return false;
                        } else {
                            $("#DataBaseTablePK").ComboBox({
                                url: "../../SystemManage/DataBaseTable/GetTableFiledListJson",
                                param: { dataBaseLinkId: $("#txt_DataBase").val(), tableName: tablename },
                                id: "column",
                                text: "column",
                                height: "350px"
                            }).ComboBoxSetValue(pk);

                            $("#Description").val(tdescription);
                            $("#EntityClassName").val(name + "Entity").attr('tableName', tablename);
                            $("#MapClassName").val(name + "Map");
                            $("#ServiceClassName").val(name + "Service");
                            $("#IServiceClassName").val("I" + name + "Service");
                            $("#BusinesClassName").val(name + "BLL");
                            $("#IBusinesClassName").val("I" + name + "BLL");
                            $("#ControllerName").val(name + "Controller");
                            $("#IndexPageName").val("Index");//name +
                            $("#FormPageName").val("Form");//name +
                        }
                        break;
                    case 2://绑定列表
                        //验证初始化配置表单
                        if (!$('#step-2').Validform()) {
                            return false;
                        }
                        BindingIndex();
                        break;
                    case 3://绑定表单
                        BindingForm();
                        break;
                    case 4://查看代码
                        LookCode()
                        break;
                    case 5://创建代码
                        CreateCode()
                        $finish.removeAttr('disabled');
                        $next.attr('disabled', 'disabled');
                        //发布功能事件
                        $("#publish_btn").click(function () {
                            $(this).attr('moduleForm', '1');
                            $("#publish_panel").show().animate({ top: 50, speed: 2000 });
                            $("#ModuleEnCode").val($("#EntityClassName").attr('tableName'));
                            $("#ModuleFullName").val($("#Description").val());
                            return false;
                        });
                        //选取功能图标
                        $("#ModuleIcon").next('.input-button').click(function () {
                            dialogOpen({
                                id: "SelectIcon",
                                title: '选取图标',
                                url: '/AuthorizeManage/Module/Icon?ControlId=ModuleIcon',
                                width: "1000px",
                                height: "600px",
                                btn: false
                            })
                        })
                        break;
                    default:
                        break;
                }
            } else {
                $finish.attr('disabled', 'disabled');
                $next.removeAttr('disabled');
            }
        });
        //完成
        $("#btn_finish").click(function () {
            if ($("#publish_btn").attr('moduleForm') == 1) {
                //自动创建功能菜单
                if (!$('#publish_panel').Validform()) {
                    return false;
                }
                var baseConfig = $("#step-2").GetWebControls();
                baseConfig["Id"] = $("#txt_DataBase").val();
                baseConfig["DataBaseTableName"] = $("#gridTable").jqGridRowValue("name");
                var postData = {
                    EnCode: $("#ModuleEnCode").val(),
                    FullName: $("#ModuleFullName").val(),
                    ParentId: $("#ModuleParentId").attr('data-value'),
                    Icon: $("#ModuleIcon").val(),
                    Description: $("#ModuleDescription").val(),
                    baseInfoJson: JSON.stringify(baseConfig)
                }
                $.SaveForm({
                    url: "../../SystemManage/CodeGenerator/PublishModule",
                    param: postData,
                    loading: "正在发布功能...",
                    success: function () {
                        dialogClose();
                    }
                })
            } else {
                dialogClose();
            }
        });
    }
    /*=========选择数据源（begin）================================================================*/
    function GetDataSource() {
        $.ajax({
            url: "../../SystemManage/DataBaseLink/GetListJson",
            type: "get",
            dataType: "json",
            async: false,
            success: function (data) {
                $.each(data, function (i) {
                    $("#txt_DataBase").append($("<option title='" + data[i].DBName + "'></option>").val(data[i].Id).html(data[i].DBAlias));
                });
            }
        });
        var $gridTable = $("#gridTable");
        $gridTable.jqGrid({
            url: "../../SystemManage/DataBaseTable/GetTableListJson",
            postData: { dataBaseLinkId: $("#txt_DataBase").val(), keyword: $("#txt_Keyword").val() },
            datatype: "json",
            height: $(window).height() - 255,
            autowidth: true,
            colModel: [
                { label: "表名", name: "name", width: 260, align: "left", sortable: false },
                { label: '主键', name: 'pk', width: 150, align: "left", sortable: false },
                {
                    label: "记录数", name: "sumrows", width: 100, align: "left", sortable: false,
                    formatter: function (cellvalue, options, rowObject) {
                        return cellvalue + "条";
                    }
                },
                { label: "使用大小", name: "reserved", width: 100, align: "left", sortable: false },
                { label: "更新时间", name: "updatetime", width: 120, align: "left", sortable: false },
                { label: "说明", name: "tdescription", width: 120, align: "left", sortable: false }
            ],
            rowNum: "1000",
            rownumbers: true,
            shrinkToFit: false,
            gridview: true,
            subGrid: true,
            subGridRowExpanded: function (subgrid_id, row_id) {
                var tableName = $gridTable.jqGrid('getRowData', row_id)['name'];
                var subgrid_table_id = subgrid_id + "_t";
                $("#" + subgrid_id).html("<table id='" + subgrid_table_id + "'></table>");
                $("#" + subgrid_table_id).jqGrid({
                    url: "../../SystemManage/DataBaseTable/GetTableFiledListJson",
                    postData: { dataBaseLinkId: $("#txt_DataBase").val(), tableName: tableName },
                    datatype: "json",
                    height: "100%",
                    colModel: [
                        { label: "列名", name: "column", index: "column", width: 250, sortable: false },
                        { label: "数据类型", name: "datatype", index: "datatype", width: 120, align: "center", sortable: false },
                        { label: "长度", name: "length", index: "length", width: 57, align: "center", sortable: false },
                        {
                            label: "允许空", name: "isnullable", index: "isnullable", width: 58, align: "center", sortable: false,
                            formatter: function (cellvalue, options, rowObject) {
                                return cellvalue == 1 ? "<i class=\"fa fa-check-square-o\"></i>" : "<i class=\"fa fa-square-o\"></i>";
                            }
                        },
                        {
                            label: "标识", name: "identity", index: "identity", width: 58, align: "center", sortable: false,
                            formatter: function (cellvalue, options, rowObject) {
                                return cellvalue == 1 ? "<i class=\"fa fa-check-square-o\"></i>" : "<i class=\"fa fa-square-o\"></i>";
                            }
                        },
                        {
                            label: "主键", name: "key", index: "key", width: 57, align: "center", sortable: false,
                            formatter: function (cellvalue, options, rowObject) {
                                return cellvalue == 1 ? "<i class=\"fa fa-check-square-o\"></i>" : "<i class=\"fa fa-square-o\"></i>";
                            }
                        },
                        { label: "默认值", name: "default", index: "default", width: 120, align: "center", sortable: false },
                        { label: "说明", name: "remark", index: "remark", width: 100, sortable: false }
                    ],
                    caption: "表字段信息",
                    rowNum: "1000",
                    rownumbers: true,
                    shrinkToFit: false,
                    gridview: true,
                    hidegrid: false
                });
            }
        });
        //查询事件
        $("#btn_Search").click(function () {
            $gridTable.jqGrid('setGridParam', {
                url: "../../SystemManage/DataBaseTable/GetTableListJson",
                postData: { dataBaseLinkId: $("#txt_DataBase").val(), keyword: $("#txt_Keyword").val() },
            }).trigger('reloadGrid');
        });
    }
    /*=========选择数据源（end）==================================================================*/

    /*=========绑定表格（begin）==================================================================*/
    var bindingTableJson = [];
    function BindingIndex() {
        $(".editview").hover(function () {
            $(this).find('.editviewtitle').show();
        }, function (e) {
            $(this).find('.editviewtitle').hide();
        });
        $(".sys_spec_text li").click(function () {
            if (!!$(this).hasClass("active")) {
                $(this).removeClass("active");
            } else {
                $(this).addClass("active").siblings("li");
            }
        });
        $("#editgrid").click(function () {
            var dataBaseLinkId = $("#txt_DataBase").val();
            var tableName = $("#gridTable").jqGridRowValue("name");
            dialogOpen({
                id: "Member",
                title: '绑定表格数据',
                url: '/GeneratorManage/SingleTable/EditGrid?dataBaseLinkId=' + dataBaseLinkId + '&tableName=' + tableName,
                width: "800px",
                height: "520px",
                callBack: function (iframeId) {
                    top.frames[iframeId].AcceptClick(function (dataJson) {
                        bindingTableJson = dataJson;
                        $('.editviewbody').html("<table id='Binding_gridTable'></table><div id='Binding_gridPager'></div>");
                        $("#Binding_gridTable").jqGrid({
                            unwritten: false,
                            datatype: "json",
                            height: 300,
                            autowidth: true,
                            colModel: dataJson.colModel,
                            viewrecords: true,
                            rowNum: 25,
                            rowList: [10, 20, 30, 50, 100],
                            pager: (dataJson.pager != true ? true : "#Binding_gridPager"),
                            sortname: '',
                            rownumbers: true,
                            shrinkToFit: false,
                            gridview: true
                        });
                    });
                }
            });
        })
    }
    /*=========绑定表格（end）====================================================================*/

    /*=========绑定表单（begin）==================================================================*/
    var bindingFormJson = [];
    function BindingForm() {
        var dataBaseLinkId = $("#txt_DataBase").val();
        var tableName = $("#gridTable").jqGridRowValue("name");
        var nameArray = [];
        if (bindingFormJson) {
            $.each(bindingFormJson, function (i) {
                nameArray.push(bindingFormJson[i].ControlId)
            });
        }
        $("#FormFieldTree").treeview({
            height: 572,
            showcheck: true,
            url: "../../SystemManage/DataBaseTable/GetTableFiledTreeJson",
            param: { dataBaseLinkId: dataBaseLinkId, tableName: tableName, nameId: String(nameArray) },
            oncheckboxclick: function (item, status) {
                if (status == 1) {
                    bindingFormJson.push({
                        ControlName: item.value,
                        ControlId: item.id,
                        ControlValidator: '',
                        ControlType: 'input'
                    })
                    //添加字段
                    var $item = $('<div class="item_row" data-value="' + item.id + '"><div class="item_field_label"><span>' + item.value + '</span></div><div class="item_field_value"></div><div class="editviewtitle">编辑控件</div></div>');
                    $("#Form_layout .item_table").append($item);
                    $item.find('.editviewtitle').click(function () {
                        var Id = $item.attr('data-value');
                        btn_editcontrol(Id);
                    })
                    $item.hover(function () {
                        $(this).find('.editviewtitle').show();
                    }, function (e) {
                        $(this).find('.editviewtitle').hide();
                    });
                } else if (status == 0) {
                    $.each(bindingFormJson, function (i) {
                        if (bindingFormJson[i].ControlId == item.id) {
                            bindingFormJson.splice(i, 1);
                            return false;
                        }
                    });
                    //删除字段
                    $("#Form_layout .item_table").find('[data-value=' + item.id + ']').remove();
                }
            }
        });
        //表单控件可以拖动
        $("#Form_layout_list").sortable({
            handle: '.item_field_label',
            placeholder: "ui-state-highlight"
        });
        //点击切换表单类型（一排、二排）
        $("#FormshowType").find('a').click(function () {
            $("#FormshowType").find('a').removeClass('active')
            if ($(this).attr('id') == "FormType1") {
                $(this).addClass('active')
                $(".app_layout .item_row").css({ width: "100%", float: "left" })
            } else if ($(this).attr('id') == "FormType2") {
                $(this).addClass('active');
                $(".app_layout .item_row").css({ width: "50%", float: "left" })
            }
        });
        //编辑控件
        function btn_editcontrol(Id) {
            dialogOpen({
                id: "EditControl",
                title: '编辑控件',
                url: '/GeneratorManage/SingleTable/EditControl?controlId=' + Id,
                width: "450px",
                height: "360px",
                callBack: function (iframeId) {
                    top.frames[iframeId].AcceptClick(function (data) {
                        if (data.ControlColspan == 1) {
                            $("#Form_layout .item_table").find('[data-value=' + Id + ']').css({ width: "100%", float: "left" })
                        } else {
                            $("#Form_layout .item_table").find('[data-value=' + Id + ']').css({ width: "50%", float: "left" })
                        }
                        $("#Form_layout .item_table").find('[data-value=' + Id + ']').find('.item_field_label span').html(data.ControlName);
                        $.each(bindingFormJson, function (i) {
                            if (bindingFormJson[i].ControlId == Id) {
                                bindingFormJson[i] = data;
                                return false;
                            }
                        });
                    });
                }
            });
        }
    }
    /*=========绑定表单（end）====================================================================*/

    /*=========查看代码（begin）==================================================================*/
    var LookCodeJson = [];
    function LookCode() {
        Loading(true, "正在生成代码...");
        window.setTimeout(function () {
            var baseConfig = $("#step-2").GetWebControls();
            baseConfig["Id"] = $("#txt_DataBase").val();
            baseConfig["DataBaseTableName"] = $("#gridTable").jqGridRowValue("name");
            var gridInfoJson = {
                IsPage: bindingTableJson.pager,
            }
            var formJson = {
                width: $("#Formwidth").val(),
                height: $("#Formheight").val(),
                FormType: $("#FormshowType .active").attr('data-value')
            }
            $.ajax({
                url: "../../GeneratorManage/SingleTable/LookCode",
                data: {
                    baseInfoJson: JSON.stringify(baseConfig),
                    gridInfoJson: JSON.stringify(gridInfoJson),
                    gridColumnJson: JSON.stringify(bindingTableJson.colModel),
                    formInfoJson: JSON.stringify(formJson),
                    formFieldJson: JSON.stringify(bindingFormJson),
                },
                type: "post",
                dataType: "json",
                async: false,
                success: function (data) {
                    var dataJons = data;
                    LookCodeJson = data;
                    $('#showCodeAreas').html('<textarea name="SyntaxHighlighter" class="brush: c-sharp;">' + dataJons["entityCode"] + '</textarea>');
                    SyntaxHighlighter.highlight();
                    $("#step-5 .nav-tabs li").click(function () {
                        var id = $(this).attr('id');
                        $('#showCodeAreas').html('<textarea name="SyntaxHighlighter" class="brush: c-sharp;">' + dataJons[id.substring(4)] + '</textarea>');
                        SyntaxHighlighter.highlight();
                    })
                },
                complete: function () {
                    Loading(false);
                }
            });
        }, 500);
    }
    /*=========查看代码（end）====================================================================*/

    /*=========自动创建（begin）==================================================================*/
    function CreateCode() {
        Loading(true, "正在创建代码...");
        window.setTimeout(function () {
            var baseConfig = $("#step-2").GetWebControls();
            $.ajax({
                url: "../../GeneratorManage/SingleTable/CreateCode",
                data: { baseInfoJson: JSON.stringify(baseConfig), strCode: encodeURIComponent(JSON.stringify(LookCodeJson)) },
                type: "post",
                dataType: "json",
                async: false,
                success: function (data) {
                    $(".drag-tip").show();
                    if (data.Status == 2000) {
                        $("#finish-msg").html(data.Message).css("color", "#0FA74F");
                        $("#finish-msg").prev('i').attr('class', 'fa fa-check-circle').css("color", "#0FA74F");
                        $("#finish-msg").next('p').show();
                    } else {
                        $("#finish-msg").html(data.Message).css("color", "#d9534f");
                        $("#finish-msg").prev('i').attr('class', 'fa fa-times-circle').css("color", "#d9534f");
                        $("#finish-msg").next('p').hide();
                    }
                },
                complete: function () {
                    Loading(false);
                }
            });
        }, 500);
    }
    /*=========自动创建（end）====================================================================*/
</script>

<div class="widget-body">
    <div id="wizard" class="wizard" data-target="#wizard-steps" style="border-left: none; border-top: none; border-right: none;">
        <ul class="steps">
            <li data-target="#step-1" class="active"><span class="step">1</span>选择数据表<span class="chevron"></span></li>
            <li data-target="#step-2"><span class="step">2</span>基本配置<span class="chevron"></span></li>
            <li data-target="#step-3"><span class="step">3</span>列表页面<span class="chevron"></span></li>
            <li data-target="#step-4"><span class="step">4</span>表单页面<span class="chevron"></span></li>
            <li data-target="#step-5"><span class="step">5</span>查看代码<span class="chevron"></span></li>
            <li data-target="#step-6"><span class="step">6</span>自动创建<span class="chevron"></span></li>
        </ul>
    </div>
    <div class="step-content" id="wizard-steps" style="border-left: none; border-bottom: none; border-right: none;">
        <div class="step-pane active" id="step-1" style="margin: 10px; margin-bottom: 0px;">
            <div class="alert alert-danger" style="text-align: left; margin-bottom: 10px;">
                <i class="fa fa-question-circle alert-dismissible" style="position: relative; top: 1px; font-size: 15px; padding-right: 5px;"></i>
                注：请选种表格中的一行 然后点击下一步进行操作
            </div>
            <div class="titlePanel">
                <div class="title-search">
                    <table>
                        <tr>
                            <th style="white-space: nowrap; font-weight: normal;">数据库：</th>
                            <td>
                                <select id="txt_DataBase" class="form-control" style="width: 100px"></select>
                            </td>
                            <td style="padding-left: 1px;">
                                <input id="txt_Keyword" type="text" class="form-control" placeholder="请输入要查询关键字" style="width: 200px;" />
                            </td>
                            <td style="padding-left: 5px;">
                                <a id="btn_Search" class="btn btn-primary"><i class="fa fa-search"></i>&nbsp;查询</a>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="gridPanel">
                <table id="gridTable"></table>
            </div>
        </div>
        <div class="step-pane" id="step-2" style="margin: 10px; margin-bottom: 0px;">
            <div class="panel panel-default" style="margin-bottom: 10px;">
                <div class="panel-heading">
                    <h3 class="panel-title">文件名配置</h3>
                </div>
                <div class="panel-body" style="width: 99%;">
                    <table class="form">
                        <tr>
                            <th class="formTitle">创建人员<font face="宋体">*</font></th>
                            <td class="formValue">
                                <input id="CreateUser" type="text" class="form-control" value="@ViewBag.UserName" isvalid="yes" checkexpession="NotNull" />
                            </td>
                            <th class="formTitle">创建日期</th>
                            <td class="formValue">
                                <input id="CreateDate" type="text" class="form-control" value="@DateTime.Now.ToString("yyyy-MM-dd HH:mm")" isvalid="yes" checkexpession="NotNull" />
                            </td>
                            <th class="formTitle">类名描述<font face="宋体">*</font></th>
                            <td class="formValue">
                                <input id="Description" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
                            </td>
                        </tr>
                        <tr>
                            <th class="formTitle">表主键名<font face="宋体">*</font></th>
                            <td class="formValue">
                                <div id="DataBaseTablePK" type="select" class="ui-select" isvalid="yes" checkexpession="NotNull">
                                </div>
                            </td>
                            <th class="formTitle">实体类名<font face="宋体">*</font></th>
                            <td class="formValue">
                                <input id="EntityClassName" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
                            </td>
                            <th class="formTitle">映射类名<font face="宋体">*</font></th>
                            <td class="formValue">
                                <input id="MapClassName" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
                            </td>

                        </tr>
                        <tr>

                            <th class="formTitle">服务类名<font face="宋体">*</font></th>
                            <td class="formValue">
                                <input id="ServiceClassName" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
                            </td>
                            <th class="formTitle">服务接口类名<font face="宋体">*</font></th>
                            <td class="formValue">
                                <input id="IServiceClassName" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
                            </td>
                        </tr>
                        <tr>
                            <th class="formTitle">业务类名<font face="宋体">*</font></th>
                            <td class="formValue">
                                <input id="BusinesClassName" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
                            </td>
                            <th class="formTitle">业务接口类名<font face="宋体">*</font></th>
                            <td class="formValue">
                                <input id="IBusinesClassName" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
                            </td>
                        </tr>
                        <tr>
                            <th class="formTitle">控制器名<font face="宋体">*</font></th>
                            <td class="formValue">
                                <input id="ControllerName" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
                            </td>
                            <th class="formTitle">列表页名<font face="宋体">*</font></th>
                            <td class="formValue">
                                <input id="IndexPageName" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
                            </td>
                            <th class="formTitle">表单页名<font face="宋体">*</font></th>
                            <td class="formValue">
                                <input id="FormPageName" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">输出目录</h3>
                </div>
                <div class="panel-body" style="width: 99%;">
                    <table class="form">
                        <tr>
                            <th class="formTitle">输出到所在区域</th>
                            <td class="formValue">
                                <div id="OutputAreas" type="select" class="ui-select" isvalid="yes" checkexpession="NotNull">
                                    <ul>
                                        <li data-value="AuthorizeManage">AuthorizeManage（系统权限）</li>
                                        <li data-value="BaseManage">BaseManage（系统基础功能）</li>
                                        <li data-value="PublicInfoManage">PublicInfoManage（系统公共功能）</li>
                                        <li data-value="SystemManage">SystemManage（系统功能）</li>
                                    </ul>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th class="formTitle">实体层输出目录</th>
                            <td class="formValue">
                                <input id="OutputEntity" readonly type="text" class="form-control" value="@ViewBag.OutputDirectory\Berry.Modes\Berry.Entity" />
                            </td>
                        </tr>
                        <tr>
                            <th class="formTitle">映射层输出目录</th>
                            <td class="formValue">
                                <input id="OutputMap" readonly type="text" class="form-control" value="@ViewBag.OutputDirectory\Berry.Modes\Berry.Entity.Mapping" />
                            </td>
                        </tr>
                        <tr>
                            <th class="formTitle">服务层输出目录</th>
                            <td class="formValue">
                                <input id="OutputService" readonly type="text" class="form-control" value="@ViewBag.OutputDirectory\Berry.Business\Berry.Service" />
                            </td>
                        </tr>
                        <tr>
                            <th class="formTitle">接口层输出目录</th>
                            <td class="formValue">
                                <input id="OutputIService" readonly type="text" class="form-control" value="@ViewBag.OutputDirectory\Berry.Business\Berry.IService" />
                            </td>
                        </tr>
                        <tr>
                            <th class="formTitle">业务层输出目录</th>
                            <td class="formValue">
                                <input id="OutputBusines" readonly type="text" class="form-control" value="@ViewBag.OutputDirectory\Berry.Business\Berry.BLL" />
                            </td>
                        </tr>
                        <tr>
                            <th class="formTitle">业务接口层输出目录</th>
                            <td class="formValue">
                                <input id="OutputIBusines" readonly type="text" class="form-control" value="@ViewBag.OutputDirectory\Berry.Business\Berry.IBLL" />
                            </td>
                        </tr>
                        <tr>
                            <th class="formTitle">应用层输出目录</th>
                            <td class="formValue">
                                <input id="OutputController" readonly type="text" class="form-control" value="@ViewBag.OutputDirectory\Berry.UI\Berry.App.Admin" />
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <div class="step-pane" id="step-3">
            <div id="BindingList" style="margin: 10px;">
                <div class="editview border" style="height: 60px;">
                    <div style="float: right;">
                        <ul class="sys_spec_text">
                            <li class="active"><a data-value="bt-replace"><i class="fa fa-refresh"></i>&nbsp;刷新</a></li>
                            <li class="active"><a data-value="bt-add"><i class="fa fa-plus"></i>&nbsp;新增</a></li>
                            <li class="active"><a data-value="bt-edit"><i class="fa fa-pencil-square-o"></i>&nbsp;编辑</a></li>
                            <li class="active"><a data-value="bt-delete"><i class="fa fa-trash-o"></i>&nbsp;删除</a></li>
                        </ul>
                    </div>
                </div>
                <div class="editview border" style="height: 490px; padding: 10px;">
                    <div class="editviewtitle" id="editgrid">
                        编辑表格
                    </div>
                    <div class="editviewbody">
                    </div>
                    <div class="editviewbodybackground" style="position: fixed; top: 120px; left: 13px; z-index: 2; width: 1073px; height: 485px; background: #fff; filter: alpha(opacity=10); opacity: 0.1;"></div>
                </div>
            </div>
        </div>
        <div class="step-pane" id="step-4">
            <div>
                <div id="FormFieldTree" class="border-right" style="width: 260px; float: left;"></div>
                <div style="margin: 0px auto; height: 100%; overflow: hidden;">
                    <div class="alert alert-danger" style="text-align: left; margin: 10px;">
                        <i class="fa fa-question-circle alert-dismissible" style="position: relative; top: 1px; font-size: 15px; padding-right: 5px;"></i>
                        注：1、请在左侧勾选需要在表单中显示的字段。2、可编辑控件参数。3、可拖动控件显示位置。
                    </div>
                    <div style="float: left; position: absolute; top: 117px; padding-left: 11px; width: 150px;">
                        <input id="Formwidth" type="text" class="form-control" placeholder="表单宽度" style="float: left; width: 60px; margin-right: 5px;" />
                        <input id="Formheight" type="text" class="form-control" placeholder="表单高度" style="float: left; width: 60px;" />
                    </div>
                    <div class="row" style="text-align: center;">
                        <div id="FormshowType" class="btn-group">
                            <a id="FormType1" class="btn btn-default active" data-value="1">一排</a>
                            <a id="FormType2" class="btn btn-default" data-value="2">二排</a>
                        </div>
                    </div>
                    <div id="Form_layout" class="app_layout" style="height: 450px; border-left: none;">
                        <div id="Form_layout_list" class="item_table"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="step-pane" id="step-5" style="margin: 5px;">
            <ul class="nav nav-tabs">
                <li class="active" id="Tab_entityCode" title="Entity"><a href="#" data-toggle="tab">实体类</a></li>
                <li id="Tab_entitymapCode" title="Mapping"><a href="#" data-toggle="tab">实体映射类</a></li>
                <li id="Tab_serviceCode" title="Service"><a href="#" data-toggle="tab">服务类</a></li>
                <li id="Tab_iserviceCode" title="IService"><a href="#" data-toggle="tab">服务接口类</a></li>
                <li id="Tab_businesCode" title="Busines"><a href="#" data-toggle="tab">业务类</a></li>
                <li id="Tab_ibusinesCode" title="IBusines"><a href="#" data-toggle="tab">业务接口类</a></li>
                <li id="Tab_controllerCode" title="Controller"><a href="#" data-toggle="tab">控制器</a></li>
                <li id="Tab_indexCode" title="Index"><a href="#" data-toggle="tab">列表页</a></li>
                <li id="Tab_formCode" title="Form"><a href="#" data-toggle="tab">表单页</a></li>
            </ul>
            <div id="showCodeAreas" class="tab-content" style="height: 525px; padding-left: 5px; padding-right: 5px; overflow: auto;">
            </div>
        </div>
        <div class="step-pane" id="step-6" style="margin: 5px; overflow: hidden; height: 600px;">
            <div class="drag-tip" style="text-align: center; padding-top: 100px; display: none;">
                <i class="fa fa-check-circle" style="font-size: 204px; color: #0FA74F;"></i>
                <div id="finish-msg" style="font-weight: bold; font-size: 24px; color: #0FA74F; margin-top: 20px;"></div>
                <p style="color: #666; font-size: 12px; margin-top: 10px;">
                    <a id="publish_btn" href="#">发布功能</a>
                </p>
            </div>
            <div id="publish_panel" style="position: absolute; height: 400px; top: 700px; z-index: 100; background: #ffffff; margin-top: 15px; margin-right: 30px;">
                <table class="form">
                    <tr>
                        <th class="formTitle">功能编号<font face="宋体">*</font></th>
                        <td class="formValue">
                            <input id="ModuleEnCode" type="text" class="form-control" placeholder="请输入编号" isvalid="yes" checkexpession="NotNull" />
                        </td>
                    </tr>
                    <tr>
                        <th class="formTitle">功能名称<font face="宋体">*</font></th>
                        <td class="formValue">
                            <input id="ModuleFullName" type="text" class="form-control" placeholder="请输入名称" isvalid="yes" checkexpession="NotNull" />
                        </td>
                    </tr>
                    <tr>
                        <th class="formTitle">功能上级<font face="宋体">*</font></th>
                        <td class="formValue">
                            <div id="ModuleParentId" type="selectTree" class="ui-select" isvalid="yes" checkexpession="NotNull"></div>
                        </td>
                    </tr>
                    <tr>
                        <th class="formTitle">功能图标<font face="宋体">*</font></th>
                        <td class="formValue">
                            <input id="ModuleIcon" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
                            <span class="input-button" title="选取图标">...</span>
                        </td>
                    </tr>
                    <tr>
                        <th class="formTitle" valign="top" style="padding-top: 4px;">
                            功能描述
                        </th>
                        <td class="formValue">
                            <textarea id="ModuleDescription" class="form-control" style="height: 70px;"></textarea>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
    <div class="form-button" id="wizard-actions">
        <a id="btn_last" disabled class="btn btn-default btn-prev">上一步</a>
        <a id="btn_next" class="btn btn-default btn-next">下一步</a>
        <a id="btn_finish" disabled class="btn btn-success">完成</a>
    </div>
</div>

<style>
    body {
        overflow: hidden;
    }

    .app_layout .item_table {
        overflow: hidden;
        border-top: 1px solid #eeecec;
        border-bottom: none;
        min-height: 400px;
    }

    .app_layout .item_row {
        cursor: default;
        position: relative;
    }

        .app_layout .item_row .item_field_label {
            cursor: move;
        }

        .app_layout .item_row:hover {
            border: 1px dashed #337ab7;
        }

        .app_layout .item_row:last-child {
            border-bottom: 1px solid #eeecec;
        }

    .app_layout .ui-state-highlight {
        border: none;
    }
</style>
